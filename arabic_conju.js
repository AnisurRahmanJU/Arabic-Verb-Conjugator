

// ১. ইনপুট ফিল্ড শো/হাইড করার ফাংশন (৩ বনাম ৪ অক্ষরের রুট)
function showFields() {
    const option3 = document.getElementById("option3");
    const inputField3 = document.getElementById("lamkalima");
    const inputField4 = document.getElementById("lam2kalima");

    if (option3 && option3.checked) {
        inputField3.style.display = "inline-block";
        inputField4.style.display = "none";
    } else {
        inputField3.style.display = "inline-block";
        inputField4.style.display = "inline-block";
    }
}

// ২. প্রধান কনজুগেশন ফাংশন
function addNumbers() {
    // ইনপুট ভ্যালুগুলো সংগ্রহ করা
    const n1 = document.getElementById("fakalima").value;
    const n2 = document.getElementById("aynkalima").value;
    const n3 = document.getElementById("lamkalima").value;
    const n4 = document.getElementById("lam2kalima").value;
    const bab = document.getElementById("dropdown").value;

    let template = [];

    // --- টেমপ্লেট লাইব্রেরি (প্রতিটি বাবের জন্য আলাদা ডাটা সেট) ---
    // ট = ১ম রুট, প = ২য় রুট, ড় = ৩য় রুট, ژ = ৪র্থ রুট
    
    if (bab == "au") { // Bab Nasara
        template = ["ٹَپَڑَ", "ٹَاپِڑٌ", "مَٹْپُوڑٌ", "", "ٹَپَڑَ", "ٹَپَڑَا", "ٹَپَڑُوا", "ٹَپَڑَتْ", "ٹَپَڑَتَا", "ٹَپَڑْنَ", "ٹَپَڑْتَ", "ٹَپَڑْتُمَا", "ٹَپَڑْتُمْ", "ٹَپَڑْتِ", "ٹَپَڑْتُمَا", "ٹَپَڑْتُنَّ", "ٹَپَڑْتُ", "ٹَپَڑْنَا", "ٹُپِڑَ", "ٹُپِڑَا", "ٹُپِڑُوا", "ٹُپِڑَتْ", "ٹُپِڑَتَا", "ٹُپِڑْنَ", "ٹُپِڑْتَ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُمْ", "ٹُپِڑْتِ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُنَّ", "ٹُپِڑْتُ", "ٹُپِڑْنَا", "يَٹْپُڑُ", "يَٹْپُڑَانِ", "يَٹْپُڑُونَ", "تَٹْپُڑُ", "تَٹْپُڑَانِ", "يَٹْپُڑْنَ", "تَٹْپُڑُ", "تَٹْپُڑَانِ", "تَٹْپُڑُونَ", "تَٹْپُڑِيْنَ", "تَٹْپُڑَانِ", "تَٹْپُڑْنَ", "أَٹْپُڑُ", "نَٹْپُڑُ", "يُٹْپَڑُ", "يُٹْپَڑَانِ", "يُٹْپَڑُونَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "يُٹْپَڑْنَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "تُٹْپَڑُونَ", "تُٹْپَڑِيْنَ", "تُٹْپَڑَانِ", "تُٹْپَڑْنَ", "أُٹْپَڑُ", "نُٹْپَڑُ", "اُٹْپُڑْ", "اُٹْپُڑَا", "اُٹْپُڑُوا", "اُٹْپُڑِي", "اُٹْپُڑَا", "اُٹْپُڑْنَ", "[ٹ پ ڑ]", "مِٹْپَڑٌ", "مَٹْپَڑٌ"];
    } 
    else if (bab == "ai") { // Bab Daraba
        template = ["ٹَپَڑَ", "ٹَاپِڑٌ", "مَٹْپُوڑٌ", "", "ٹَپَڑَ", "ٹَپَڑَا", "ٹَپَڑُوا", "ٹَپَڑَتْ", "ٹَپَڑَتَا", "ٹَپَڑْنَ", "ٹَپَڑْتَ", "ٹَپَڑْتُمَا", "ٹَپَڑْتُمْ", "ٹَپَڑْتِ", "ٹَپَڑْتُمَا", "ٹَپَڑْتُنَّ", "ٹَپَڑْتُ", "ٹَپَڑْنَا", "ٹُپِڑَ", "ٹُپِڑَا", "ٹُپِڑُوا", "ٹُپِڑَتْ", "ٹُپِڑَتَا", "ٹُپِڑْنَ", "ٹُپِڑْتَ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُمْ", "ٹُپِڑْتِ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُنَّ", "ٹُپِڑْتُ", "ٹُپِڑْنَا", "يَٹْپِڑُ", "يَٹْپِڑَانِ", "يَٹْپِڑُونَ", "تَٹْپِڑُ", "تَٹْپِڑَانِ", "يَٹْپِڑْنَ", "تَٹْپِڑُ", "تَٹْپِڑَانِ", "تَٹْپِڑُونَ", "تَٹْپِڑِيْنَ", "تَٹْپِڑَانِ", "تَٹْپِڑْنَ", "أَٹْپِڑُ", "نَٹْپِڑُ", "يُٹْپَڑُ", "يُٹْپَڑَانِ", "يُٹْپَڑُونَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "يُٹْپَڑْنَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "تُٹْپَڑُونَ", "تُٹْپَڑِيْنَ", "تُٹْپَڑَانِ", "تُٹْپَڑْنَ", "أُٹْپَڑُ", "نُٹْپَڑُ", "اِٹْپِڑْ", "اِٹْپِڑَا", "اِٹْپِڑُوا", "اِٹْپِڑِي", "اِٹْپِڑَا", "اِٹْپِڑْنَ", "[ٹ پ ڑ]", "مِٹْپَڑٌ", "مَٹْپَڑٌ"];
    }
    else if (bab == "aa") { // Bab Fatha
        template = ["ٹَپَڑَ", "ٹَاپِڑٌ", "مَٹْپُوڑٌ", "", "ٹَپَڑَ", "ٹَپَڑَا", "ٹَپَڑُوا", "ٹَپَڑَتْ", "ٹَپَڑَتَا", "ٹَپَڑْنَ", "ٹَپَڑْتَ", "ٹَپَڑْتُمَا", "ٹَپَڑْتُمْ", "ٹَپَڑْتِ", "ٹَپَڑْتُمَا", "ٹَپَڑْتُنَّ", "ٹَپَڑْتُ", "ٹَپَڑْنَا", "ٹُپِڑَ", "ٹُپِڑَا", "ٹُپِڑُوا", "ٹُپِڑَتْ", "ٹُپِڑَتَا", "ٹُپِڑْنَ", "ٹُپِڑْتَ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُمْ", "ٹُپِڑْتِ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُنَّ", "ٹُپِڑْتُ", "ٹُپِڑْنَا", "يَٹْپَڑُ", "يَٹْپَڑَانِ", "يَٹْپَڑُونَ", "تَٹْپَڑُ", "تَٹْپَڑَانِ", "يَٹْپَڑْنَ", "تَٹْپَڑُ", "تَٹْپَڑَانِ", "تَٹْپَڑُونَ", "تَٹْپَڑِيْنَ", "تَٹْپَڑَانِ", "تَٹْپَڑْنَ", "أَٹْپَڑُ", "نَٹْپَڑُ", "يُٹْپَڑُ", "يُٹْپَڑَانِ", "يُٹْپَڑُونَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "يُٹْپَڑْنَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "تُٹْپَڑُونَ", "تُٹْپَڑِيْنَ", "تُٹْپَڑَانِ", "تُٹْپَڑْنَ", "أُٹْپَڑُ", "نُٹْپَڑُ", "اِٹْپَڑْ", "اِٹْپَڑَا", "اِٹْپَڑُوا", "اِٹْپَڑِي", "اِٹْپَڑَا", "اِٹْپَڑْنَ", "[ٹ پ ڑ]", "مِٹْپَڑٌ", "مَٹْپَڑٌ"];
    }
    else if (bab == "ia") { // Bab Samia
        template = ["ٹَپِڑَ", "ٹَاپِڑٌ", "مَٹْپُوڑٌ", "", "ٹَپِڑَ", "ٹَپِڑَا", "ٹَپِڑُوا", "ٹَپِڑَتْ", "ٹَپِڑَتَا", "ٹَپِڑْنَ", "ٹَپِڑْتَ", "ٹَپِڑْتُمَا", "ٹَپِڑْتُمْ", "ٹَپِڑْتِ", "ٹَپِڑْتُمَا", "ٹَپِڑْتُنَّ", "ٹَپِڑْتُ", "ٹَپِڑْنَا", "ٹُپِڑَ", "ٹُپِڑَا", "ٹُپِڑُوا", "ٹُپِڑَتْ", "ٹُپِڑَتَا", "ٹُپِڑْنَ", "ٹُپِڑْتَ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُمْ", "ٹُپِڑْتِ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُنَّ", "ٹُپِڑْتُ", "ٹُپِڑْنَا", "يَٹْپَڑُ", "يَٹْپَڑَانِ", "يَٹْپَڑُونَ", "تَٹْپَڑُ", "تَٹْپَڑَانِ", "يَٹْپَڑْنَ", "تَٹْپَڑُ", "تَٹْپَڑَانِ", "تَٹْپَڑُونَ", "تَٹْپَڑِيْنَ", "تَٹْپَڑَانِ", "تَٹْپَڑْنَ", "أَٹْپَڑُ", "نَٹْپَڑُ", "يُٹْپَڑُ", "يُٹْپَڑَانِ", "يُٹْپَڑُونَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "يُٹْپَڑْنَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "تُٹْپَڑُونَ", "تُٹْپَڑِيْنَ", "تُٹْپَڑَانِ", "تُٹْپَڑْنَ", "أُٹْپَڑُ", "نُٹْپَڑُ", "اِٹْپَڑْ", "اِٹْپَڑَا", "اِٹْپَڑُوا", "اِٹْپَڑِي", "اِٹْپَڑَا", "اِٹْپَڑْنَ", "[ٹ پ ڑ]", "مِٹْپَڑٌ", "مَٹْپَڑٌ"];
    }
    else if (bab == "uu") { // Bab Karuma
        template = ["ٹَپُڑَ", "ٹَپِيڑٌ", "مَٹْپُوڑٌ صِلة", "", "ٹَپُڑَ", "ٹَپُڑَا", "ٹَپُڑُوا", "ٹَپُڑَتْ", "ٹَپُڑَتَا", "ٹَپُڑْنَ", "ٹَپُڑْتَ", "ٹَپُڑْتُمَا", "ٹَپُڑْتُمْ", "ٹَپُڑْتِ", "ٹَپُڑْتُمَا", "ٹَپُڑْتُنَّ", "ٹَپُڑْتُ", "ٹَپُڑْنَا", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "ٹُپِڑَ صِلَة", "يَٹْپُڑُ", "يَٹْپُڑَانِ", "يَٹْپُڑُونَ", "تَٹْپُڑُ", "تَٹْپُڑَانِ", "يَٹْپُڑْنَ", "تَٹْپُڑُ", "تَٹْپُڑَانِ", "تَٹْپُڑُونَ", "تَٹْپُڑِيْنَ", "تَٹْپُڑَانِ", "تَٹْپُڑْنَ", "أَٹْپُڑُ", "نَٹْپُڑُ", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "يُٹْپَڑُ صِلَة", "اُٹْپُڑْ", "اُٹْپُڑَا", "اُٹْپُڑُوا", "اُٹْپُڑِي", "اُٹْپُڑَا", "اُٹْپُڑْنَ", "[ٹ پ ڑ]", "مِٹْپَڑٌ", "مَٹْپَڑٌ"];
    }
    else if (bab == "ii") { // Bab Hasiba
        template = ["ٹَپِڑَ", "ٹَاپِڑٌ", "مَٹْپُوڑٌ", "", "ٹَپِڑَ", "ٹَپِڑَا", "ٹَپِڑُوا", "ٹَپِڑَتْ", "ٹَپِڑَتَا", "ٹَپِڑْنَ", "ٹَپِڑْتَ", "ٹَپِڑْتُمَا", "ٹَپِڑْتُمْ", "ٹَپِڑْتِ", "ٹَپِڑْتُمَا", "ٹَپِڑْتُنَّ", "ٹَپِڑْتُ", "ٹَپِڑْنَا", "ٹُپِڑَ", "ٹُپِڑَا", "ٹُپِڑُوا", "ٹُپِڑَتْ", "ٹُپِڑَتَا", "ٹُپِڑْنَ", "ٹُپِڑْتَ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُمْ", "ٹُپِڑْتِ", "ٹُپِڑْتُمَا", "ٹُپِڑْتُنَّ", "ٹُپِڑْتُ", "ٹُپِڑْنَا", "يَٹْپِڑُ", "يَٹْپِڑَانِ", "يَٹْپِڑُونَ", "تَٹْپِڑُ", "تَٹْپِڑَانِ", "يَٹْپِڑْنَ", "تَٹْپِڑُ", "تَٹْپِڑَانِ", "تَٹْپِڑُونَ", "تَٹْپِڑِيْنَ", "تَٹْپِڑَانِ", "تَٹْپِڑْنَ", "أَٹْپِڑُ", "نَٹْپِڑُ", "يُٹْپَڑُ", "يُٹْپَڑَانِ", "يُٹْپَڑُونَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "يُٹْپَڑْنَ", "تُٹْپَڑُ", "تُٹْپَڑَانِ", "تُٹْپَڑُونَ", "تُٹْپَڑِيْنَ", "تُٹْپَڑَانِ", "تُٹْپَڑْنَ", "أُٹْپَڑُ", "نُٹْپَڑُ", "اِٹْپِڑْ", "اِٹْپِڑَا", "اِٹْپِڑُوا", "اِٹْپِڑِي", "اِٹْپِڑَا", "اِٹْپِڑْنَ", "[ٹ پ ڑ]", "مِٹْپَڑٌ", "مَٹْپَڑٌ"];
    }

    // --- ৩. রুট রিপ্লেসমেন্ট লজিক ---
    // যদি টেমপ্লেট না পাওয়া যায় তবে রিটার্ন করবে
    if (template.length === 0) return;

    const finalData = template.map(item => 
        item.replace(/ٹ/g, n1).replace(/پ/g, n2).replace(/ڑ/g, n3).replace(/ژ/g, n4)
    );

    // --- ৪. অটোমেটিক টেবিল আপডেট লজিক ---
    // fa-1 থেকে fa-68 পর্যন্ত আইডিগুলোর ডাটা ইনডেক্স
    const mapping = [
        4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, // Past Active (1-14)
        18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, // Past Passive (15-28)
        32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, // Present Active (29-42)
        46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, // Present Passive (43-56)
        60, 61, 62, 63, 64, 65 // Command (63-68)
    ];

    mapping.forEach((templateIdx, i) => {
        let elementId = (i < 56) ? "fa-" + (i + 1) : "fa-" + (i - 56 + 63);
        let cell = document.getElementById(elementId);
        if (cell) {
            cell.innerText = finalData[templateIdx];
        }
    });

    // ৫. ওপরের রেজাল্ট সেকশন আপডেট
    document.getElementById("main-fial").innerText = finalData[0];
    document.getElementById("file").innerText = (bab == "uu") ? "صِفة مُشبة: " + finalData[1] : "اسم فاعل: " + finalData[1];
    document.getElementById("maful").innerText = "اسم مَفعول: " + finalData[2];
    document.getElementById("masdar").innerText = " مصدر: " + finalData[3];
    document.getElementById("mada").innerText = " مَادة: " + finalData[66];
    document.getElementById("ismala").innerText = "اسم آلة: " + finalData[67];
    document.getElementById("ismjarf").innerText = "اسم ظرف: " + finalData[68];

    // ৬. ইংরেজি মেসেজ রিমুভ করা
    const resultMsg = document.getElementById("result");
    if (resultMsg) resultMsg.innerText = "";
}

// পেজ লোড হওয়ার সময় ফিল্ড চেক করা
window.onload = showFields;
